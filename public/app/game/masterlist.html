<div class="view-wrapper">
    <input type="text" id="game-search" placeholder="Sök i alla regioner" ng-model="q" ng-change="search()" ng-minlength="3" />
    <h3 style="margin: 0 5px" ng-if="showQ">{{games.length}} spel hittades</h3>
    <a href ng-click="getGames()">GIMME GEMZ</a>
    <ul id="games" infinite-scroll="getGames()" infinite-scroll-disabled="isFetching" infinite-scroll-distance="3">
            <li ng-repeat="game in games" ng-if="!game.isRemoved" ng-class-odd="'odd'" ng-class-even="'even'">
                <div class="master-wrapper">
                    <a ng-class="{complete: game.isComplete}" ui-sref="game({consoleName:game.data.console, regionName:game.data.regions.main, subRegionName:game.data.regions.sub[0], gameName:game.data.name.split(' ').join('-')})">
                        <div class="game-name">
                            <span>
                                {{game.data.name}}
                                <span>({{game.data.regions.sub[0].toUpperCase()}})</span>
                            </span>
                        </div></a><a href ng-click="editGame(game)" ng-class="{disabled: !$parent.loggedIn}"><div class="game-data"><div class="game-attr">
                                <div class="common">
                                    <span ng-if="game.data.variants.length === 1" ng-repeat="attr in game.data.variants[0].attr.common" ng-class="{exists: attr.status}">{{attr.id.toUpperCase()}}</span>
                                    <div ng-if="game.data.variants.length > 1" ng-repeat="v in game.data.variants" style="display: inline-block;margin-right:5px">
                                        <span ng-repeat="attr in v.attr.common" ng-class="{exists: attr.status}" style="margin-right: 0">
                                            {{attr.id.toUpperCase()}}
                                        </span>
                                        <span ng-if="$index !== game.data.variants.length-1">/</span>
                                    </div>
                                </div><span ng-if="game.data.variants.length === 1 && game.variants[0].attr.extras.length" ng-class="{exists: game.attr.extrasComplete}">+</span>
                            </div></div></a>
                </div>
                <div class="game-content" ng-if="game.id === selected.id">
                    <div style="display: inline-block;width:100%">
                        <div ng-repeat="variant in selected.variants">
                            <h3 ng-if="variant.desc.length" style="margin: 0">{{variant.desc}}</h3>
                            <ul>
                                <li ng-repeat="attr in variant.attr.common" style="padding: 0; margin-right: 20px">
                                    <input id="{{selected.id + '_' + $parent.$index + '_' + attr.id}}" type="checkbox" ng-model="attr.status" ng-checked="attr.status" ng-change="attrChanged($parent.$index, $index, attr.status)">
                                    <label for="{{selected.id + '_' + $parent.$index + '_' + attr.id}}">{{attr.longName}} <span ng-if="attr.desc.length">({{attr.desc}})</span></label>
                                </li>
                            </ul>
                            <ul ng-if="variant.attr.extras.length">
                                <li ng-repeat="attr in variant.attr.extras" style="padding: 0; display: inline; margin-right: 20px">
                                    <label style="color: #6495ed" for="{{selected.id + '_' + $parent.$index + '_' + attr.id}}">{{attr.longName}}:</label>
                                    <input id="{{selected.id + '_' + $parent.$index + '_' + attr.id}}" type="checkbox" ng-model="attr.status" ng-checked="attr.status">
                                </li>
                            </ul>
                            <div>
                                <label for="{{selected.id + '_' + $parent.$index + '_' + '_note'}}">Anteckning:</label>
                                <input id="{{selected.id + '_' + $parent.$index + '_' + '_note'}}" type="text" ng-model="variant.attr.note" style="border: 1px solid #ccc;width:50%">
                            </div>
                        </div>
                    </div>
                    <div>
                        <button ng-disabled="!isDirty(game.variants)" class="yeah" ng-click="updateGame(game)">Spara</button>
                        <span ng-if="willRemove">Spelet kommer att tas bort från din samling.</span>
                    </div>
                </div>
            </li>
    </ul>
</div>
